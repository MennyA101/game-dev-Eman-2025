<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Game Level 1 - With Restart</title>
<style>
  body {
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    background-color: #333;
    font-family: 'Courier New', Courier, monospace;
    color: white;
  }

  canvas {
    background-color: #70c5ce;
    border: 4px solid #000;
    display: block;
  }

  .ui-container {
    margin-top: 15px;
    text-align: center;
  }

  #status {
    font-size: 24px;
    font-weight: bold;
    text-transform: uppercase;
    margin-bottom: 10px;
    height: 30px; /* Prevents layout jump */
  }

  /* Styling the Restart Button */
  #restartBtn {
    padding: 10px 25px;
    font-size: 18px;
    font-family: 'Courier New', Courier, monospace;
    font-weight: bold;
    background-color: #F4D03F;
    border: 3px solid #000;
    cursor: pointer;
    text-transform: uppercase;
  }

  #restartBtn:hover {
    background-color: #fff;
  }

  #restartBtn:active {
    transform: translateY(2px);
  }
</style>
</head>
<body>

<div id="status">Navigate through the pipe!</div>
<canvas id="gameCanvas" width="800" height="400"></canvas>

<div class="ui-container">
  <button id="restartBtn" onclick="restartGame()">Restart Level</button>
  <p>Use <b>WASD</b> to Move</p>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const statusText = document.getElementById("status");

let bird, pipe, levelComplete = false;
const keys = {};

function init() {
  // Reset Player
  bird = {
    x: 100,
    y: 200,
    w: 30,
    h: 30,
    speed: 4,
    color: "#F4D03F"
  };

  // Reset Pipe
  pipe = {
    x: 500,
    w: 80,
    gapY: 120,
    gapH: 150,
    color: "#2D5A27"
  };

  levelComplete = false;
  statusText.innerText = "Navigate through the pipe!";
  statusText.style.color = "white";
}

// Function triggered by the button
function restartGame() {
  init();
}

window.addEventListener("keydown", e => keys[e.code] = true);
window.addEventListener("keyup", e => keys[e.code] = false);

function update() {
  if (levelComplete) return;

  if (keys["KeyW"]) bird.y -= bird.speed;
  if (keys["KeyS"]) bird.y += bird.speed;
  if (keys["KeyA"]) bird.x -= bird.speed;
  if (keys["KeyD"]) bird.x += bird.speed;

  // Canvas boundaries
  if (bird.x < 0) bird.x = 0;
  if (bird.y < 0) bird.y = 0;
  if (bird.y + bird.h > canvas.height) bird.y = canvas.height - bird.h;

  // Completion check
  if (bird.x > pipe.x + pipe.w) {
    levelComplete = true;
    statusText.innerText = "Level Completed!";
    statusText.style.color = "#2ecc71";
  }
}

function draw() {
  ctx.fillStyle = "#70c5ce";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Draw Pipe
  ctx.fillStyle = pipe.color;
  ctx.fillRect(pipe.x, 0, pipe.w, pipe.gapY);
  ctx.fillRect(pipe.x, pipe.gapY + pipe.gapH, pipe.w, canvas.height);

  // Draw Pipe Lips
  ctx.fillStyle = "#1e3d1a";
  ctx.fillRect(pipe.x - 5, pipe.gapY - 20, pipe.w + 10, 20);
  ctx.fillRect(pipe.x - 5, pipe.gapY + pipe.gapH, pipe.w + 10, 20);

  // Draw Player
  ctx.fillStyle = bird.color;
  ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
  ctx.fillStyle = "black";
  ctx.fillRect(bird.x + bird.w - 8, bird.y + 6, 4, 4);
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

init();
gameLoop();
</script>

</body>
</html>
